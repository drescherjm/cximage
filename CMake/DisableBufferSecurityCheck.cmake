option (DISABLE_BUFFER_SECURITY_CHECK		"Disable buffer security checking" ON)

macro (RESET_BUFFER_SECURITY_CHECK)
	if (DISABLE_BUFFER_SECURITY_CHECK)
		set(CMAKE_CXX_FLAGS_RELWITHDEBINFO "${CMAKE_CXX_FLAGS_RELWITHDEBINFO} /GS-")
		set(CMAKE_CXX_FLAGS_RELEASE "${CMAKE_CXX_FLAGS_RELEASE} /GS-")
		STRING( REGEX MATCH "BUFFER_SECURITY_CHECK_DISABLED" __IS_A_MATCH__ ${CMAKE_CXX_FLAGS})
		IF (NOT __IS_A_MATCH__)
			SET(CMAKE_CXX_FLAGS "${CMAKE_CXX_FLAGS} -DBUFFER_SECURITY_CHECK")
		ENDIF(NOT __IS_A_MATCH__)
	else(DISABLE_BUFFER_SECURITY_CHECK)
		string(REPLACE "/GS-" "/GS" CMAKE_CXX_FLAGS_RELWITHDEBINFO "${CMAKE_CXX_FLAGS_RELWITHDEBINFO}")
		string(REPLACE "/GS-" "/GS" CMAKE_CXX_FLAGS_RELEASE "${CMAKE_CXX_FLAGS_RELEASE}")
	endif(DISABLE_BUFFER_SECURITY_CHECK)
endmacro (RESET_BUFFER_SECURITY_CHECK)

RESET_BUFFER_SECURITY_CHECK()