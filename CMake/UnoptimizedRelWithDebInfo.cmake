option (DISABLE_OPTIMIZATIONS_ON_RELWITHDEBINFO 		"Disable all optimizations on RelWithDebInfo" ON)

macro (RESET_OPTIMIZATIONS)
	if (DISABLE_OPTIMIZATIONS_ON_RELWITHDEBINFO)
		string(REPLACE "/O2" "/Od" CMAKE_CXX_FLAGS_RELWITHDEBINFO "${CMAKE_CXX_FLAGS_RELWITHDEBINFO}")
		STRING( REGEX MATCH "OPTIMIZATION_DISABLED" __IS_A_MATCH__ ${CMAKE_CXX_FLAGS_RELWITHDEBINFO})
		IF (NOT __IS_A_MATCH__)
			SET(CMAKE_CXX_FLAGS_RELWITHDEBINFO "${CMAKE_CXX_FLAGS_RELWITHDEBINFO} -DOPTIMIZATION_DISABLED")
		ENDIF(NOT __IS_A_MATCH__)
	else(DISABLE_OPTIMIZATIONS_ON_RELWITHDEBINFO)
		string(REPLACE "/Od" "/O2" CMAKE_CXX_FLAGS_RELWITHDEBINFO "${CMAKE_CXX_FLAGS_RELWITHDEBINFO}")
	endif(DISABLE_OPTIMIZATIONS_ON_RELWITHDEBINFO)
endmacro (RESET_OPTIMIZATIONS)

RESET_OPTIMIZATIONS()